# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger: none

stages:
- stage: stage
  displayName: stage
  jobs:
  - job: 'job'
    pool:
      vmImage: windows-2019

    steps:

    - script: |
        $RutaOriginal = $env:System_DefaultWorkingDirectory
        $RutaActualizada = $RutaOriginal -replace '\\', '\\\\'
        [Environment]::SetEnvironmentVariable("RutaActualizada", $RutaActualizada, [System.EnvironmentVariableTarget]::User)
        Write-Host "RutaActualizada=$RutaActualizada"


      displayName: echo NewWorkingDirectory
      
    # - task: UsePythonVersion@0
    #   inputs:
    #     versionSpec: '3.x'
    #     addToPath: true
    #     architecture: 'x64'

    # - script: |
    #     pip install Lackey
    #     pip install PyAutoGUI
    #   displayName: Pip install modules

    # - task: PythonScript@0
    #   displayName: Lackey test
    #   inputs:
    #     scriptSource: 'inline'
    #     script: |
    #       import time
    #       from lackey import *

    #       app = App(0)

    #       type("notepad")
    #       type(Key.ENTER)

    #       wait(5)

    #       type("Hola, este es un texto de ejemplo.")

    #       type(Key.CTRL + 's')
    #       wait(2)
    #       type("$(NewWorkingDirectory)/test.txt")  
    #       type(Key.ENTER)

    #       wait(2)

    #       app.close()

    # - task: PublishBuildArtifacts@1
    #   displayName: Publish artifacts
    #   inputs:
    #     PathtoPublish: '$(NewWorkingDirectory)/test.txt'
    #     ArtifactName: 'drop_$(Build.Repository.Name)'
    #     publishLocation: 'Container'