trigger: none

variables:
- group: Alejo-test-sonar
- group: alejo-var-back

- name: sonarTest
  value: sonar.verbose=false ; sonar.c.file.suffixes=- ; sonar.cpp.file.suffixes=- ; sonar.objc.file.suffixes=-


stages:
- stage: stage
  displayName: stage
  jobs:
  - job: 'job'
    pool:
      vmImage: ubuntu-latest
    steps:

    - script: |
        propiedades="$(sonarPropertiesLibrary2)"

        # Reemplazar ';' por saltos de lÃ­nea y escribir en el archivo
        echo "$propiedades" | sed 's/;/\n/g' > sonar-project.properties

    - script: |
        tree
        cat sonar-project.properties
    # - checkout: git://training-quind/training-AlejandroFront@master
    #   fetchDepth: 1

    # - task: SonarCloudPrepare@1
    #   displayName: 'Configure Static Code Analysis'
    #   inputs:
    #     SonarCloud: 'sonarcloud-Alejandro'
    #     organization: 'quind'
    #     scannerMode: 'CLI'
    #     configMode: 'manual'
    #     cliProjectKey: '$(Build.Repository.Name)'
    #     # cliProjectName: '$(Build.Repository.Name)'
    #     cliSources: '$(System.DefaultWorkingDirectory)'
    #     extraProperties: |
    #         sonar.exclusions= **/node_modules/**,**/*.test.js,**/alejo-helm/** \n sonar.testExecutionReportPaths=test-report.xml \n sonar.javascript.lcov.reportPaths=coverage/lcov.info \n sonar.projectName=alejovarTest

    # - task: Npm@1
    #   displayName: 'Install Dependencies'
    #   inputs:
    #     workingDir: $(System.DefaultWorkingDirectory)
    #     verbose: true
    
    # - task: Npm@1
    #   displayName: 'jest sonar reporter'
    #   inputs:
    #     command: 'custom'
    #     workingDir: $(System.DefaultWorkingDirectory)
    #     verbose: true
    #     customCommand: 'i -D jest-sonar-reporter'

    # - task: Npm@1
    #   displayName: 'Compile'
    #   inputs:
    #     command: 'custom'
    #     workingDir: $(System.DefaultWorkingDirectory)
    #     verbose: true
    #     customCommand: 'run build'
        
    # - task: SonarCloudAnalyze@1
    #   displayName: 'Configure Static Code Analysis'

    # - task: Npm@1
    #   displayName: 'Unit Tests'
    #   inputs:
    #     command: 'custom'
    #     workingDir: $(System.DefaultWorkingDirectory)
    #     verbose: true
    #     customCommand: 'run test'
        
    # - task: SonarCloudPublish@1
    #   inputs:
    #     pollingTimeoutSec: '300'



